<div class="container mb-5" style="margin-top: 8%;">
  <div class="heading_container heading_center d-flex">
    <h2 class="mx-auto my-4">
      Edit Incident
    </h2>
   
  </div>
  <div class="row">
    <form [formGroup]="accidentForm" id="print-section" (ngSubmit)="submitData()"
      class="col-md-10 mx-auto d-flex flex-wrap">

      <table class="table">
        <tr>
          <td colspan="2">
            <div class="form-group">
              <label class="form-label" for="rigId">Rig Number: </label>
              <select name="rigId" formControlName="rigId" [(ngModel)]="accident.rigId" id="rigId" class="form-select">
                <option value="" disabled selected>Choose Rig Number</option>
                <option *ngFor="let item of rigList" value="{{item.id}}">Rig-{{item.number}}</option>
              </select>
            </div>
          </td>
          <td>
            <div class="form-group   ">
              <label>Date Of Event :</label>
              <input id="Date" type="date" formControlName="dateOfEvent" class="form-control"
                [(ngModel)]="accident.dateOfEvent" [ngModel]="accident.dateOfEvent | date: 'yyyy-MM-dd'" />
              <div *ngIf="dateOfEvent?.invalid && (dateOfEvent?.dirty || dateOfEvent?.touched)">
                <small class="text-danger" *ngIf="dateOfEvent?.errors?.['required']">
                  Date Of Event is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="2">
            <div class="from-group  ">
              <label for="classificationOfAccidentId" class="form-label">Classification Of Incident :</label>
              <select name="classificationOfAccidentId" formControlName="classificationOfAccidentId"
                [(ngModel)]="accident.classificationOfAccidentId" id="classificationOfAccidentId" class="form-select">
                <option value="" disabled selected>Choose Classification Of Incident</option>
                <option *ngFor="let item of classificationOfAccidentList" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
          </td>
          <td>
            <div class="form-group">
              <label>Time Of Event :</label>
              <input type="time" class="form-control" formControlName="timeOfEvent"
                [(ngModel)]="accident.timeOfEvent" />
              <div *ngIf="timeOfEvent?.invalid && (timeOfEvent?.dirty || timeOfEvent?.touched)">
                <small class="text-danger" *ngIf="timeOfEvent?.errors?.['required']">
                  Time Of Event is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <div class="form-group">
              <label class="form-label" for="accidentCausesId">Incident Causes : </label>
              <select name="accidentCausesId" formControlName="accidentCausesId" [(ngModel)]="accident.accidentCausesId"
                id="accidentCausesId" class="form-select">
                <option value="" disabled selected>Choose Incident Causes</option>
                <option *ngFor="let item of accidentCausesList" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
          </td>
          <!-- <td>
            <div class="form-group  ">
              <label class="form-label">Driller Name : </label>
              <input type="text" formControlName="drillerName" class="form-control"
                [(ngModel)]="accident.drillerName" />
              <div *ngIf="drillerName?.invalid && (drillerName?.dirty || drillerName?.touched)">
                <small class="text-danger" *ngIf="drillerName?.errors?.['required']">
                  Driller Name is required
                </small>
              </div>
            </div>
          </td> -->
        </tr>

        <tr>
          <td colspan="2">
            <div class="form-group">
              <label class="form-label" for="preventionCategoryId">Prevention Category :</label>
              <select name="preventionCategoryId" formControlName="preventionCategoryId"
                [(ngModel)]="accident.preventionCategoryId" id="preventionCategoryId" class="form-select">
                <option value="" disabled selected>Choose Prevention </option>
                <option *ngFor="let item of preventionCategoryList" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
          </td>
          <td>
            <div class="form-group  ">
              <label class="form-label">Incident Location : </label>
              <input type="text" formControlName="accidentLocation" [(ngModel)]="accident.accidentLocation"
                class="form-control" />
              <div *ngIf="accidentLocation?.invalid && (accidentLocation?.dirty || accidentLocation?.touched)">
                <small class="text-danger" *ngIf="accidentLocation?.errors?.['required']">
                  Incident Location is required
                </small>
              </div>
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <div class="from-group">
              <label for="typeOfInjuryID" class="form-label">Type Of Injury :</label>
              <select name="typeOfInjuryID" formControlName="typeOfInjuryID" [(ngModel)]="accident.typeOfInjuryID"
                id="typeOfInjuryID" class="form-select">
                <option value="" disabled selected>Choose Type Of Injury</option>
                <option *ngFor="let item of typeOfInjuryList" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
          </td>
          <td colspan="2">
            <div class="from-group">
              <label for="violationCategoryId" class="form-label">Violation Category :</label>
              <select name="violationCategoryId" formControlName="violationCategoryId"
                [(ngModel)]="accident.violationCategoryId" id="violationCategoryId" class="form-select">
                <option value="" disabled selected>Choose Violation Category</option>
                <option *ngFor="let item of violationCategoryList" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <label class="form-label m-0 pb-0">QHSE Employee Code: </label>
            <input list="QHSEmenace" [(ngModel)]="QHSE_Code" autocomplete="off" formControlName="qHSEEmpCode" name="qHSEEmpCode" class="form-control" (input)="selectedMenace($event)">
            <datalist id="QHSEmenace">
              <option *ngFor="let menace of QHSECodeList">{{menace.code}} </option>
            </datalist>
          </td>
          <td>
            <div class="from-group">
              <label for="qHSEPositionName" class="form-label">QHSE Position :</label>
              <input class="form-control" [value]="QHSE_Position" disabled />
              <input name="qHSEPositionName" formControlName="qHSEPositionName" id="qHSEPositionName" class="form-control"
                [(ngModel)]="QHSE_Position" hidden />
            </div>
          </td>
          <td>
            <div class="form-group">
              <label class="form-label" for="qHSEEmpName">Name :</label>
              <input class="form-control" [value]="QHSE_Name" disabled />
              <input name="qHSEEmpName" formControlName="qHSEEmpName" id="qHSEEmpName"
                class="form-control" [(ngModel)]="QHSE_Name" hidden />
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <label class="form-label m-0 pb-0">Tool Pusher Code : </label>
            <input list="QHSEmenace" [(ngModel)]="Pusher_Code" autocomplete="off" formControlName="pusherCode" name="pusherCode" class="form-control" (input)="selectedMenaceTool($event)">
            <datalist id="pusherCode">
              <option *ngFor="let menace of QHSECodeList">{{menace.code}} </option>
            </datalist>
          </td>
          <td>
            <div class="from-group">
              <label for="pusherPositionName" class="form-label">Tool Pusher Position :</label>
              <input class="form-control" [value]="PusherPosition" disabled />
              <input name="pusherPositionName" formControlName="pusherPositionName" id="pusherPositionName"
                class="form-control" [(ngModel)]="PusherPosition" hidden />
            </div>
          </td>
          <td>
            <div class="form-group">
              <label class="form-label" for="pusherName">Name :</label>
              <input class="form-control" [value]="Pusher_Name" disabled />
              <input name="pusherName" formControlName="pusherName"
                id="pusherName" class="form-control" [(ngModel)]="Pusher_Name" hidden />
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <label class="form-label m-0 pb-0">Driller Code: </label>
            <input list="QHSEmenace" [(ngModel)]="Driller_Code" autocomplete="off" formControlName="drillerCode" name="drillerCode" class="form-control" (input)="selectedMenaceDriller($event)">
            <datalist id="drillerCode">
              <option *ngFor="let menace of QHSECodeList">{{menace.code}} </option>
            </datalist>
          </td>
          <td>
            <div class="from-group">
              <label for="drillerPositionName" class="form-label">Position :</label>
              <input class="form-control" [value]="DrillerPosition" disabled />
              <input name="drillerPositionName" formControlName="drillerPositionName" id="drillerPositionName" class="form-control"
                [(ngModel)]="DrillerPosition" hidden />
            </div>
          </td>
          <td>
            <div class="form-group">
              <label class="form-label" for="drillerName">Name :</label>
              <input class="form-control" [value]="Driller_Name" disabled />
              <input name="drillerName" formControlName="drillerName" id="drillerName"
                class="form-control" [(ngModel)]="Driller_Name" hidden />
            </div>
          </td>
        </tr>

        <tr>
          <td>
            <label class="form-label m-0 pb-0">The injured person Code: </label>
            <input list="QHSEmenace" [(ngModel)]="InjuredPerson_Code" autocomplete="off" formControlName="injuredPersonCode" name="injuredPersonCode" class="form-control" (input)="selectedMenaceInjuredPerson($event)">
            <datalist id="injuredPersonCode">
              <option *ngFor="let menace of QHSECodeList">{{menace.code}} </option>
            </datalist>
          </td>
          <td>
            <div class="from-group">
              <label for="injuredPersonPositionName" class="form-label">Position :</label>
              <input class="form-control" [value]="InjuredPersonPosition" disabled />
              <input name="injuredPersonPositionName" formControlName="injuredPersonPositionName" id="injuredPersonPositionName" class="form-control"
                [(ngModel)]="InjuredPersonPosition" hidden />
            </div>
          </td>
          <td>
            <div class="form-group">
              <label class="form-label" for="injuredPersonName">Name :</label>
              <input class="form-control" [value]="InjuredPerson_Name" disabled />
              <input name="injuredPersonName" formControlName="injuredPersonName" id="injuredPersonName"
                class="form-control" [(ngModel)]="InjuredPerson_Name" hidden />
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <label for="Description">Description Of The Event:</label>
            <textarea class="form-control " formControlName="descriptionOfTheEvent"
              [(ngModel)]="accident.descriptionOfTheEvent" rows="4" id="Description" name="text"></textarea>
            <div
              *ngIf="descriptionOfTheEvent?.invalid && (descriptionOfTheEvent?.dirty || descriptionOfTheEvent?.touched)">
              <small class="text-danger" *ngIf="descriptionOfTheEvent?.errors?.['required']">
                Description Of The Event is required
              </small>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <div class="form-group   ">
              <label class="form-label">Immediate Action Taken  : </label>
              <input type="text" formControlName="immediateActionType" [(ngModel)]="accident.immediateActionType"
                class="form-control" />
              <div *ngIf="immediateActionType?.invalid && (immediateActionType?.dirty || immediateActionType?.touched)">
                <small class="text-danger" *ngIf="immediateActionType?.errors?.['required']">
                  immediateActionType is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <div class="form-group  ">
              <label for="DirectCauses" class="form-label">Direct Causes : </label>
              <textarea class="form-control" formControlName="directCauses" [(ngModel)]="accident.directCauses" rows="4"
                id="DirectCauses" name="text"></textarea>
              <div *ngIf="directCauses?.invalid && (directCauses?.dirty || directCauses?.touched)">
                <small class="text-danger" *ngIf="directCauses?.errors?.['required']">
                  Direct Causes is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <div class="form-group">
              <label class="form-label">Root Causes : </label>
              <textarea class="form-control" formControlName="rootCauses" [(ngModel)]="accident.rootCauses" rows="4"
                id="Description" name="text"></textarea>
              <div *ngIf="rootCauses?.invalid && (rootCauses?.dirty || rootCauses?.touched)">
                <small class="text-danger" *ngIf="rootCauses?.errors?.['required']">
                  rootCauses is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <div class="form-group   ">
              <label class="form-label">Recommendations : </label>
              <textarea class="form-control" formControlName="recommendations" [(ngModel)]="accident.recommendations"
                rows="4" id="Description" name="text"></textarea>
              <div *ngIf="recommendations?.invalid && (recommendations?.dirty || recommendations?.touched)">
                <small class="text-danger" *ngIf="recommendations?.errors?.['required']">
                  recommendations is required
                </small>
              </div>
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="3">
            <div class="form-group">
              <label class="form-label">Photos : </label>
              <input type="file" formControlName="images" name="images" class="form-control"
                (change)="GetImagePath($event)" multiple #fileInput/>
              <div *ngIf="images?.invalid && (images?.dirty || images?.touched)">
                <small class="text-danger" *ngIf="images?.errors?.['required']">
                  Photos is required
                </small>
              </div>
            </div>
          </td>
        </tr>
        <tr>

          <td>
            <div class="row" >
              <div *ngFor="let imageUrl of accident.imagess" class="col-4 mx-2 my-2">
                <img src="http://localhost:5000/AccidentIMG/{{imageUrl}}" alt="Image" width="100%" height="auto">
              </div>
            </div>
          </td>
          
        </tr>
      </table>


      <input type="submit" class="btn btn-success me-3" value="Submit" />
      <input routerLink="/PrintAccident" type="submit" class="btn btn-primary" value="Show Data">

    </form>
  </div>
</div>
